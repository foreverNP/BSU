# РЕШЕНИЕ ЗАДАЧИ О РЮКЗАКЕ АЛГОРИТМОМ ДИНАМИЧЕСКОГО ПРОГРАММИРОВАНИЯ

**Задача о рюкзаке** (англ. Knapsack problem) — дано n предметов, предмет i имеет массу $w_i > 0$ и стоимость $p_i > 0$. Необходимо выбрать из этих предметов такой набор, чтобы суммарная масса не превосходила заданной величины W (вместимость рюкзака), а суммарная стоимость была максимальна.

Рассмотрим задачу **Неограниченный рюкзак** (англ. Unbounded Knapsack Problem), в которой любой предмет может быть выбран любое количество раз.

## Формулировка Задачи

Каждый предмет может быть выбран любое число раз. Задача выбрать количество $x_i$ предметов каждого типа так, чтобы

максимизировать общую стоимость: $\sum_{i=1}^{n} p_i x_i$;

выполнялось условие совместности: $\sum_{i=1}^{n} w_i x_i \leq W$;

где $x_i \geq 0$ целое, для всех $i = 1, 2, \ldots, n$.

## ПРИМЕР РЕШЕНИЯ ЗАДАЧИ

Решить задачу:

$\max 1x_1 + 3x_2 + 4x_3$

s.t. $2x_1 + 2x_2 + 3x_3 \leq 6$

$x_1, x_2, x_3 \geq 0$ — целые.

Для заполнения таблицы будем использовать следующий алгоритм:

$\text{KNAPSACK}(n, W)$

1: **for** $w = 1$ to $W$ **do**
2: $\quad f[0, w] = 0$;
3: **end for**
4: **for** $i = 1$ to $n$ **do**
5: $\quad$ **for** $w = 1$ to $W$ **do**
6: $\quad\quad f[i, w] := \max\{f[i-1, w], v_i + f[i-1, w-w_i]\}$;
7: $\quad\quad$ **if** $f[i, w] = f[i-1, w]$ **then**
8: $\quad\quad\quad p[i, w] := 0$
9: $\quad\quad$ **else**
10: $\quad\quad\quad p[i, w] := 1$
11: $\quad\quad$ **end if**
12: $\quad$ **end for**
13: **end for**
14: **return** $f[n, W]$;

### Решение:

| w | $f_1$ | $p_1$ | $f_2$ | $p_2$ | $f_3$ | $p_3$ |
|---|-------|-------|-------|-------|-------|-------|
| 0 | 0     | 0     | 0     | 0     | 0     | 0     |
| 1 | 0     | 0     | 0     | 0     | 0     | 0     |
| 2 | 1     | 1     | 3     | 1     | 0     | 0     |
| 3 | 1     | 1     | 3     | 1     | 4     | 1     |
| 4 | 2     | 1     | 6     | 1     | 6     | 0     |
| 5 | 2     | 1     | 6     | 1     | 6     | 0     |
| 6 | 3     | 1     | 9     | 1     | 9     | 0     |

Оптимальное решение задачи: $OPT = f_3(6) = 9$.

---

## Обратный ход:

Стартуем с $x_1 = x_2 = x_3 = 0$.

$p_3(6) = 0$, следовательно $x_3 = x_3 + 0$.

Объем не изменился, осталось 6 единиц.

$p_2(6) = 1 \Rightarrow x_2 = x_2 + 1$;

Объем изменился, осталось 6-2=4 единицы.

$p_2(4) = 1 \Rightarrow x_2 = x_2 + 1$;

Объем изменился, осталось 4-2=2 единицы.

$p_2(2) = 1 \Rightarrow x_2 = x_2 + 1$;

Объем изменился, осталось 2-2=0 единиц.

Стоп. Оптимальное решение задачи: $x_1 = 0, x_2 = 3, x_3 = 0$.