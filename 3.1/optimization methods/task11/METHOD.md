### Алгоритм метода потенциалов решения матричных транспортных задач (выписанный дословно):

#### 1. Расчет потенциалов
Строкам поставим в соответствие потенциалы \( u_i, \, i = 1, m \), столбцам \(-v_j, \, j = 1, n\) (на рисунках записываем слева от строк и над столбцами). Общая формула для вычисления потенциалов имеет вид:
\[ u_i + v_j = -c_{ij}, \quad (i, j) \in U_B, \]
а на практике поступают следующим образом: для некоторой строки или столбца (как правило, с наибольшим числом базисных клеток) полагают потенциал равным 0.

**Замечание 0.1:** Возможно, в лекциях потока ПМ другой знак:
\[ u_i + v_j = c_{ij}, \quad (i, j) \in U_B. \]

#### 2. Подсчет оценок
Подсчитываем оценки (записываем их в клетку):
\[ \Delta_{ij} = -c_{ij} - (u_i + v_j), \quad (i, j) \in U_H. \]

**Замечание 0.2:** Возможно, в лекциях потока ПМ другой знак:
\[ \Delta_{ij} = c_{ij} - (u_i + v_j), \quad (i, j) \in U_H. \]

#### 3. Проверка условий оптимальности
\[
\Delta_{ij} \leq 0 \text{ при } x_{ij} = 0,
\]
\[
\Delta_{ij} \geq 0 \text{ при } x_{ij} = d_{ij}, \quad (i, j) \in U_H.
\]
При их выполнении сетевой поток \( x \) оптимален, решение прекращаем. Иначе переходим к следующему шагу.

#### 4. Выбор клетки \((i_0, j_0)\)
\[
|\Delta_{i_0,j_0}| = \max |\Delta_{ij}|,
\]
где максимум берется по всем небазисным клеткам, на которых нарушаются условия оптимальности.

Эту клетку будем добавлять в базис. Вместе с другими базисными клетками получится ровно один цикл.

Этой клетке припишем знак \( + \), если \( x_{i_0,j_0} = 0 \), и знак \( - \), если \( x_{i_0,j_0} = d_{i_0,j_0} \). Начиная с этой клетки, обойдем цикл, чередуя знаки \( + \) и \( - \).

#### 5. Подсчет шагов
Для клеток цикла подсчитаем шаги:
\[
\theta_{ij} =
\begin{cases}
d_{ij} - x_{ij}, & \text{если } (i, j) - \text{клетка со знаком } +; \\
x_{ij}, & \text{если } (i, j) - \text{клетка со знаком } -,
\end{cases}
\]
и минимальный шаг:
\[
\theta^0 = \min_{\substack{(i, j) \in \text{циклу}}} \theta_{ij}.
\]

#### 6. Построение нового базисного плана
\[
\bar{x}_{ij} =
\begin{cases}
x_{ij} + \theta^0, & \text{если } (i, j) - \text{клетка со знаком } +; \\
x_{ij} - \theta^0, & \text{если } (i, j) - \text{клетка со знаком } -; \\
x_{ij}, & \text{если } (i, j) - не из цикла,
\end{cases}
\]
\((i, j) \in U.\)

#### 7. Обновление базисного множества клеток
Отметим новое базисное множество клеток: если \( \theta^0 = \theta_{i_0j_0} \), то \( \bar{U}_B = U_B \), если \( \theta^0 = \theta_{i_*j_*} \), то
\[
\bar{U}_B = (U_B \setminus \{(i_*, j_*)\}) \cup \{(i_0, j_0)\}.
\]

### Первая фаза для матричной транспортной задачи:

Для построения начального базисного плана перевозок используется **первая фаза метода потенциалов**, которая состоит в следующем.

Добавляется искусственный пункт производства \( A_{m+1} \) (искусственная строка) \( a_{m+1} = \sum_{j=1}^n b_j \) и искусственный пункт потребления \( B_{n+1} \) (искусственный столбец) с интенсивностью \( a_{m+1} = \sum_{i=1}^m a_i \). Стоимость перевозок:

- \( c_{ij} = 0 \) для клеток исходной таблицы и клеток \( (m+1, n+1) \) (она не считается искусственной);
- \( c_{ij} = 1 \) для искусственных клеток.

Начальный базис — все искусственные клетки. Начальный поток:

- \( x_{ij} = 0 \) для клеток исходной таблицы и клеток \( (m+1, n+1) \);
- \( x_{m+1, j} = b_j \) для искусственной строки;
- \( x_{i, n+1} = a_i \) для искусственного столбца.

Задача первой фазы решается методом потенциалов.

В результате решения задачи первой фазы получим оптимальный план перевозок \( x^* \) с базисным множеством клеток \( U_B^* \), который обладает одним из следующих свойств:

1. Существует клетка \( (i_*, j_*) \in U_I \), что \( x_{i_*, j_*} \neq 0 \);
2. \( x_{ij}^0 = 0 \), \( (i, j) \in U_I \); среди базисных клеток имеется лишь одна искусственная;
3. \( x_{ij}^0 = 0 \), \( (i, j) \in U_I \); среди базисных клеток имеется больше одной искусственной.

---

**Разбор случаев**:

- **Случай 1**: исходная задача не имеет решения.
- **Случай 2**: отбрасываем искусственные строки и столбцы. Получим начальный базисный поток исходной задачи.
- **Случай 3**: берём среди небазисных клеток исходной таблицы клетку \( (i_*, j_*) \), которая с базисными клетками образует цикл. Выводим искусственную из базиса, заменив её клеткой \( (i_*, j_*) \). Через конечное число шагов придём к случаю 2.