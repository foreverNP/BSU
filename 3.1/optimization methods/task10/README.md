### Алгоритм метода потенциалов:

#### **1. Вычисление потенциалов узлов:**
   - Решите систему уравнений:
     \[
     u_i - u_j = -c_{ij}, \; \forall (i, j) \in U_B,
     \]
     где \( U_B \) — множество базисных дуг, \( u_i \) — потенциал узла \( i \), а \( c_{ij} \) — стоимость потока.
   - Задайте значение одного потенциала произвольно (чаще всего \( u_1 = 0 \)).
   - Остальные потенциалы определяются однозначно.

---

#### **2. Вычисление оценок небазисных дуг:**
   - Для всех дуг из \( U_H = U \setminus U_B \) рассчитайте оценки:
     \[
     \Delta_{ij} = -c_{ij} - (u_i - u_j).
     \]

---

#### **3. Проверка условий оптимальности:**
   - Условия оптимальности:
     \[
     \Delta_{ij} \leq 0, \; \text{если } x_{ij} = 0;
     \]
     \[
     \Delta_{ij} \geq 0, \; \text{если } x_{ij} = d_{ij}.
     \]
   - Если эти условия выполняются для всех дуг из \( U_H \), базисный поток оптимален, и алгоритм завершается.
   - В противном случае переходите к следующему шагу.

---

#### **4. Выбор небазисной дуги и добавление её в базис:**
   - Выберите дугу \( (i_0, j_0) \), которая нарушает условия оптимальности:
     \[
     |\Delta_{i_0 j_0}| = \max_{(i, j) \in U_H} |\Delta_{ij}|,
     \]
     где максимум берётся по всем небазисным дугам, для которых не выполняются условия оптимальности.
   - Добавьте выбранную дугу \( (i_0, j_0) \) в базисное множество \( U_B \), образуя цикл.
   - Если \( x_{i_0 j_0} = 0 \), обходите цикл в направлении \( i_0 \to j_0 \).
   - Если \( x_{i_0 j_0} = d_{i_0 j_0} \), обходите цикл в направлении \( j_0 \to i_0 \).

---

#### **5. Корректировка потоков и определение \(\theta^0\):**
   - Для всех дуг цикла рассчитайте:
     \[
     \theta_{ij} =
     \begin{cases}
     d_{ij} - x_{ij}, & (i, j) \in U_\mathcal{Ц}^+, \\
     x_{ij}, & (i, j) \in U_\mathcal{Ц}^-,
     \end{cases}
     \]
     где \( U_\mathcal{Ц}^+ \) и \( U_\mathcal{Ц}^- \) — множества прямых и обратных дуг цикла соответственно.
   - Определите:
     \[
     \theta^0 = \min_{(i, j) \in U_\mathcal{Ц}} \theta_{ij}.
     \]

---

#### **6. Обновление потоков и базиса (разделение случаев):**
   - **(a)** Если \( \theta^0 = \theta_{i_0 j_0} \), то базисное множество \( U_B \) остаётся прежним, а базисный поток обновляется:
     \[
     x_{ij} =
     \begin{cases}
     x_{ij} + \theta^0, & (i, j) \in U_\mathcal{Ц}^+, \\
     x_{ij} - \theta^0, & (i, j) \in U_\mathcal{Ц}^-, \\
     x_{ij}, & (i, j) \in U \setminus U_\mathcal{Ц}.
     \end{cases}
     \]
     Если для всех дуг выполнены условия оптимальности, решение завершается. В противном случае переходите к шагу 4.
   - **(b)** Если \( \theta^0 = \theta_{i_* j_*} \), где \((i_*, j_*) \in U_B\), замените базисное множество \( U_B \) на:
     \[
     U_B = (U_B \setminus \{(i_*, j_*)\}) \cup \{(i_0, j_0)\}.
     \]
     Пересчитайте базисный поток и переходите к шагу 1.

### Алгоритм первой фазы метода потенциалов:
Как и для любого численного метода, для решения транспортной задачи
необходим начальный базисный сетевой поток.
Метод построения начального базисного потока состоит в решении
вспомогательной задачи, которая называется первой фазой метода
потенциалов. Ее суть состоит в следующем.
1. **Выбор начальных потоков:**
   - Возьмём любые дуговые потоки исходной задачи, лежащие на одной из границ:
     \[
     \tilde{x}_{ij} = 0 \quad \text{или} \quad \tilde{x}_{ij} = d_{ij}, \; \forall (i, j) \in U.
     \]

2. **Подсчёт невязок:**
   - Рассчитайте невязки \( \omega_i \) для всех узлов:
     \[
     \omega_i = a_i - \sum_{j \in I^+_i} \tilde{x}_{ij} + \sum_{j \in I^-_i} \tilde{x}_{ji},
     \]
     где \( a_i \) — интенсивность узла \( i \), \( I^+_i \) и \( I^-_i \) — множества узлов, в которые исходят и из которых приходят дуги узла \( i \), соответственно.

3. **Добавление искусственного узла:**
   - Введите искусственный узел \( m + 1 \) и соедините его с узлом \( i \):
     - Искусственной дугой \( (i, m+1) \), если \( \omega_i \geq 0 \);
     - Искусственной дугой \( (m+1, i) \), если \( \omega_i < 0 \).

4. **Задание ограничений на искусственные дуги:**
   - Для каждой искусственной дуги установите ограничения на поток:
     \[
     0 \leq x_{ij} \leq |\omega_i|, \; \forall (i, j) \in U_I,
     \]
     где \( U_I \) — множество всех искусственных дуг.

5. **Формулировка задачи первой фазы:**
   - Сформулируйте вспомогательную задачу:
     \[
     \sum_{(i, j) \in U_I} x_{ij} \to \min,
     \]
     при ограничениях:
     \[
     \sum_{j \in I^+_i} x_{ij} - \sum_{j \in I^-_i} x_{ji} = a_i, \; \forall i = 1, \ldots, m+1,
     \]
     \[
     0 \leq x_{ij} \leq d_{ij}, \; \forall (i, j) \in U,
     \]
     \[
     0 \leq x_{ij} \leq |\omega_i|, \; \forall (i, j) \in U_I.
     \]

6. **Начальный базисный сетевой поток:**
   - Начальный базисный сетевой поток для задачи (4) имеет вид:
     \[
     x_{ij} = |\omega_i|, \; \forall (i, j) \in U_I,
     \]
     с базисным множеством дуг \( U_B = U_I \).

7. **Решение вспомогательной задачи:**
   - Решите вспомогательную задачу методом потенциалов, чтобы найти базисный поток \( x^* \) и множество дуг \( U_B^* \).

8. **Проверка искусственных дуг:**
   - Если в решении задачи вспомогательной задачи:
     - Все потоки в искусственных дугах равны нулю (\( x_{ij}^* = 0, \; \forall (i, j) \in U_I \)), то переходите ко второй фазе метода потенциалов.
     - Если \( x_{ij}^* \neq 0 \) для хотя бы одной дуги:
       - Если в базис входит только одна искусственная дуга, удалите её из базиса и переходите к решению исходной задачи.
       - Если в базис входят несколько искусственных дуг, заменяйте их дугами из исходной сети до тех пор, пока все искусственные дуги не будут исключены.