**Задача о рюкзаке**

Задача о рюкзаке имеет следующую интерпретацию. Пусть имеется \(n\) неделимых предметов с номерами \(i, i = 1, n\). Вес \(i\)-го предмета равен \(p_i\), его ценность \(c_i\). Требуется выбрать совокупность предметов с минимальным общим весом при условии, что общая ценность груза не меньше заданной величины \(c\).

Построим математическую модель задачи. Введём переменные \(x_i, i = 1, n\), которые принимают лишь два значения: \(x_i = 1\), если данный предмет укладывается в рюкзак, \(x_i = 0\) — в противном случае. Тогда математическая модель задачи о рюкзаке имеет вид:

\[
f(x) = \sum_{i=1}^{n} p_i x_i \to \min, \quad \sum_{i=1}^{n} c_i x_i \geq c, \quad x_i = 0 \, \text{или} \, 1, \, i = 1, n.
\]

Применим к решению этой задачи метод ветвей и границ. Опишем алгоритм дробления и связанную с ним систему оценок дробления. Пусть \(X\) — множество планов задачи (10.6). Расширим его до "непрерывного"

\[
\bar{X} = \{ x : \sum_{i=1}^n c_i x_i \geq c, 0 \leq x_i \leq 1, i = 1, n \},
\]

т.е. будем считать, что все предметы допускают произвольную делимость без потери относительной ценности (т.е. ценности на единицу веса). В качестве оценки множества \(X\) рассмотрим следующую величину:

\[
\xi(X) = \min f(x), \quad x \in \bar{X}.
\]

Очевидно, \(\xi(X) \leq \min f(x), x \in X\), т.е. удовлетворяет первому свойству метода ветвей и границ.

Метод решения задачи (2) состоит в следующем. Подсчитаем относительные веса предметов, т.е. вес \(p_i / c_i\) \(i\)-го предмета на единицу ценности. Выберем предмет с номером \(i_1\) с наименьшим относительным весом и будем загружать его (точнее, "засыпать" в дроблённом виде) в рюкзак до тех пор, пока не будет достигнута заданная ценность \(c\) или же не будет "засыпан" весь предмет. Первый случай имеет место, если \(c_{i_1} \geq c\), и тогда

\[
x_{i_1}^* = \frac{c}{c_{i_1}}, \quad x_i^* = 0, \, i = 1, n, \, i \neq i_1,
\]

будет оптимальным планом задачи (2).

Второй случай реализуется, если \(c_{i_1} < c\). Полагаем \(x_{i_1}^* = 1\), и среди оставшихся предметов выбираем предмет \(i_2\) с наименьшим относительным весом. С ним поступаем так же, как и с первым, только сейчас вместо \(c\) берём \(c - c_{i_1}\).

Продолжая этот процесс, либо построим оптимальный план \(x^* = (x_1^*, \dots, x_n^*)\) задачи (2), либо не достигнем заданной ценности. Последнее реализуется, если

\[
\sum_{i=1}^n c_i < c,
\]

а это означает, что задача не имеет решения из-за несовместности ограничений.

Пусть \(x^*\) — оптимальный план задачи (2). Если все его координаты целочисленны, т.е. равны 0 или 1, то этот план будет оптимальным и для исходной задачи (1). В противном случае разбиваем множество \(X\) на два множества:

\[
X_1 = \{ x \in X : x_1 = 0 \}, \quad X_2 = \{ x \in X : x_1 = 1 \}.
\]

В качестве оценок этих множеств берём следующие числа:

\[
\xi(X_1) = \min \left( \sum_{i=2}^n p_i x_i, \quad \sum_{i=2}^n c_i x_i \geq c, \, 0 \leq x_i \leq 1, \, i = 2, n \right),
\]

\[
\xi(X_2) = \min \left( p_1 + \sum_{i=2}^n p_i x_i, \quad \sum_{i=2}^n c_i x_i \geq c - c_1, \, 0 \leq x_i \leq 1, \, i = 2, n \right).
\]

Задачи (3) и (4) решаются, как и задача (2). Если в задаче (3) \(X_1 = \emptyset\), тогда полагают \(\xi(X_1) = \infty\). Если в задаче (3) \(c - c_1 \leq 0\), тогда \(x_1^* = 1, x_i^* = 0, i = 2, n\), — оптимальный план задачи (3).

**Замечание**. Если оптимальный план \(x^*\) задачи (3) или (4) целочисленный, то соответствующее множество разбивается на два подмножества, одно из которых состоит из элемента \(x^*\), а второе получается удалением \(x^*\) из исходного. В дальнейшем эти множества не подвергаются разбиению, а их оценки равны оценке множества, из которого они получены.

Дальнейшее решение задачи проводится в соответствии с выбранной схемой ветвления.
